# EstaciÃ³n MeteorolÃ³gica IoT

Sistema completo de estaciÃ³n meteorolÃ³gica basado en Arduino/ESP32 con dashboard web y almacenamiento en base de datos de series temporales.

## ğŸ“‹ CaracterÃ­sticas

- **Sensores MeteorolÃ³gicos**: Temperatura, humedad, presiÃ³n, viento, lluvia
- **Conectividad**: WiFi con protocolo MQTT
- **Base de Datos**: InfluxDB para datos de series temporales
- **Dashboard**: React/Next.js con TypeScript + Grafana para visualizaciÃ³n
- **API REST**: Backend en Node.js/Express
- **Alertas**: Sistema de notificaciones automÃ¡ticas
- **ExportaciÃ³n**: Datos en CSV/JSON
- **Frontend Moderno**: Material-UI 7.3.1, Chart.js, Leaflet maps

## ğŸ—ï¸ Arquitectura del Sistema

### Diagrama General del Sistema
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ“¡ ESTACIÃ“N METEOROLÃ“GICA IOT                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸŒ¡ï¸ SENSORES    â”‚    â”‚   ğŸ“¶ CONECTIVIDAD â”‚    â”‚   ğŸ’» BACKEND     â”‚    â”‚   ğŸ“Š FRONTEND    â”‚
â”‚                  â”‚    â”‚                  â”‚    â”‚                  â”‚    â”‚                  â”‚
â”‚ DHT22 (Temp/Hum) â”‚    â”‚                  â”‚    â”‚   Node.js/Expressâ”‚    â”‚   React/Next.js  â”‚
â”‚ BMP180 (PresiÃ³n) â”‚    â”‚    ğŸ“¡ WiFi       â”‚    â”‚   Puerto: 5002   â”‚    â”‚   Puerto: 3001+  â”‚
â”‚ BH1750 (Luz)     â”‚â—„â”€â”€â–ºâ”‚       +          â”‚â—„â”€â”€â–ºâ”‚                  â”‚â—„â”€â”€â–ºâ”‚                  â”‚
â”‚ MH-RD (Lluvia)   â”‚    â”‚    ğŸ”— MQTT       â”‚    â”‚   ğŸ”„ Middlewares â”‚    â”‚   ğŸ“ˆ Dashboard   â”‚
â”‚ MQ7 (CO)         â”‚    â”‚   Puerto: 1883   â”‚    â”‚   â€¢ Rate Limit   â”‚    â”‚   â€¢ Material-UI  â”‚
â”‚ MQ135 (Aire)     â”‚    â”‚   WS: 9001       â”‚    â”‚   â€¢ Validation   â”‚    â”‚   â€¢ Chart.js     â”‚
â”‚ DSM501A (PM2.5)  â”‚    â”‚                  â”‚    â”‚   â€¢ CORS         â”‚    â”‚   â€¢ Leaflet Maps â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â”‚                        â”‚
         â”‚                        â”‚                        â”‚                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               ğŸ“Š ALMACENAMIENTO Y VISUALIZACIÃ“N                            â”‚
â”‚                                  â”‚                        â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                        â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ğŸ—„ï¸ InfluxDB   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   ğŸ“ˆ Grafana    â”‚   â”‚
â”‚  â”‚                 â”‚                                                   â”‚                 â”‚   â”‚
â”‚  â”‚  â€¢ Time-series  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚  â€¢ Dashboards   â”‚   â”‚
â”‚  â”‚  â€¢ Weather data â”‚              â”‚   ğŸ”´ Redis      â”‚                  â”‚  â€¢ Alertas      â”‚   â”‚
â”‚  â”‚  â€¢ Puerto: 8086 â”‚              â”‚                 â”‚                  â”‚  â€¢ Puerto: 3000 â”‚   â”‚
â”‚  â”‚  â€¢ Bucket: data â”‚              â”‚  â€¢ Cache        â”‚                  â”‚  â€¢ admin/pass   â”‚   â”‚
â”‚  â”‚  â€¢ Org: station â”‚              â”‚  â€¢ Sessions     â”‚                  â”‚  â€¢ Datasources  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â€¢ Puerto: 6379 â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              ğŸ³ Docker Compose OrquestaciÃ³n
```

### Flujo de Datos Detallado

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                   ğŸ“Š FLUJO DE DATOS                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1ï¸âƒ£ CAPTURA DE DATOS (ESP8266/WEMOS)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“¡ ESP8266     â”‚â”€â”€â”€â”€ 60s interval â”€â”€â”€â”€â”
â”‚   WEMOS D1 R2    â”‚                      â”‚
â”‚                  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ Sensores I2C   â”‚  â”‚  ğŸ“‹ JSON Payload                       â”‚
â”‚ â€¢ GPIO Digital   â”‚  â”‚  {                                     â”‚
â”‚ â€¢ ADC AnalÃ³gico  â”‚  â”‚    "station_id": "WEMOS_STATION_001", â”‚
â”‚ â€¢ Interrupciones â”‚  â”‚    "timestamp": millis(),             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    "temperature": 25.67,              â”‚
                      â”‚    "humidity": 65.23,                 â”‚
                      â”‚    "pressure": 1013.25,               â”‚
                      â”‚    "light_level": 1234.56,            â”‚
                      â”‚    "rainfall": 0.2,                   â”‚
                      â”‚    "co_level": 2.45,                  â”‚
                      â”‚    "air_quality_digital": 0,           â”‚
                      â”‚    "dust_pm25": 12.34,                â”‚
                      â”‚    "uptime": 12345,                    â”‚
                      â”‚    "signal_strength": -45,             â”‚
                      â”‚    "free_heap": 25600                  â”‚
                      â”‚  }                                     â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2ï¸âƒ£ TRANSMISIÃ“N MQTT
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ğŸ“¡ WiFi     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“¤ Publisher   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   ğŸ”— MQTT Broker â”‚
â”‚   ESP8266        â”‚               â”‚   Mosquitto      â”‚
â”‚                  â”‚  Topic:       â”‚   Puerto: 1883   â”‚
â”‚ â€¢ Auto-reconnect â”‚  weather/data/â”‚   WS: 9001       â”‚
â”‚ â€¢ QoS Level 0    â”‚  WEMOS_STATIONâ”‚                  â”‚
â”‚ â€¢ JSON Payload   â”‚  _001         â”‚ â€¢ Retain: false  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â€¢ Persistence    â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3ï¸âƒ£ PROCESAMIENTO BACKEND (Node.js)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ’» Backend API Server (Puerto: 5002)                                               â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  ğŸ”— MQTT Client â”‚    â”‚  âš¡ Middleware  â”‚    â”‚  ğŸ—„ï¸ InfluxDB    â”‚                  â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚  Client          â”‚                  â”‚
â”‚  â”‚ â€¢ mqttService   â”‚â”€â”€â”€â–ºâ”‚ â€¢ Validation    â”‚â”€â”€â”€â–ºâ”‚                 â”‚                  â”‚
â”‚  â”‚ â€¢ Auto-connect  â”‚    â”‚ â€¢ Rate Limiting â”‚    â”‚ â€¢ writeWeather  â”‚                  â”‚
â”‚  â”‚ â€¢ Message Queue â”‚    â”‚ â€¢ CORS Handler  â”‚    â”‚ â€¢ Timestamp Fix â”‚                  â”‚
â”‚  â”‚ â€¢ Error Recoveryâ”‚    â”‚ â€¢ Body Parser   â”‚    â”‚ â€¢ Batch Writes  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                   â”‚                       â”‚                          â”‚
â”‚                                   â–¼                       â–¼                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  âš ï¸ Alert Engineâ”‚    â”‚  ğŸ“Š API Routes  â”‚    â”‚  ğŸ“„ Data Export â”‚                  â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚                  â”‚
â”‚  â”‚ â€¢ Threshold     â”‚    â”‚ â€¢ /weather/*    â”‚    â”‚ â€¢ CSV Format    â”‚                  â”‚
â”‚  â”‚ â€¢ Suppression   â”‚    â”‚ â€¢ /alerts/*     â”‚    â”‚ â€¢ JSON Format   â”‚                  â”‚
â”‚  â”‚ â€¢ Notifications â”‚    â”‚ â€¢ /health       â”‚    â”‚ â€¢ Time Ranges   â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4ï¸âƒ£ ALMACENAMIENTO (InfluxDB)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ—„ï¸ InfluxDB Time-Series Database (Puerto: 8086)                                   â”‚
â”‚                                                                                     â”‚
â”‚  ğŸ“Š Bucket: weather-data    ğŸ¢ Org: weather-station                                 â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  ğŸ“ˆ Measurement â”‚    â”‚  ğŸ·ï¸ Tags         â”‚    â”‚  ğŸ“Š Fields       â”‚                 â”‚
â”‚  â”‚  "weather"      â”‚    â”‚                 â”‚    â”‚                 â”‚                 â”‚
â”‚  â”‚                 â”‚    â”‚ â€¢ station_id    â”‚    â”‚ â€¢ temperature   â”‚                 â”‚
â”‚  â”‚ Time-based      â”‚    â”‚ â€¢ location      â”‚    â”‚ â€¢ humidity      â”‚                 â”‚
â”‚  â”‚ Auto-indexing   â”‚    â”‚ â€¢ sensor_type   â”‚    â”‚ â€¢ pressure      â”‚                 â”‚
â”‚  â”‚ Retention       â”‚    â”‚                 â”‚    â”‚ â€¢ light_level   â”‚                 â”‚
â”‚  â”‚ Compression     â”‚    â”‚                 â”‚    â”‚ â€¢ rainfall      â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5ï¸âƒ£ VISUALIZACIÃ“N Y MONITOREO
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             ğŸ“Š Frontend Interfaces                                   â”‚
â”‚                                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   ğŸŒ React Dashboard (Puerto 3001+) â”‚    â”‚   ğŸ“ˆ Grafana (Puerto: 3000)        â”‚  â”‚
â”‚  â”‚                                     â”‚    â”‚                                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“Š Components   â”‚                â”‚    â”‚  â”‚ ğŸ“‹ Dashboards   â”‚                â”‚  â”‚
â”‚  â”‚  â”‚                 â”‚                â”‚    â”‚  â”‚                 â”‚                â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Current Data  â”‚â—„â”€â”€â”€â”€ API â”€â”€â”€â”€â”€â”â”‚    â”‚  â”‚ â€¢ Weather Panel â”‚â—„â”€â”€â”€ Flux â”€â”€â”€â”€â”â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Historical    â”‚              â”‚â”‚    â”‚  â”‚ â€¢ Alert Panel   â”‚              â”‚â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Weather Maps  â”‚              â”‚â”‚    â”‚  â”‚ â€¢ System Health â”‚              â”‚â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ Alerts Panel  â”‚              â”‚â”‚    â”‚  â”‚ â€¢ Custom Queriesâ”‚              â”‚â”‚  â”‚
â”‚  â”‚  â”‚ â€¢ System Status â”‚              â”‚â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚â”‚    â”‚                                   â”‚â”‚  â”‚
â”‚  â”‚                                   â”‚â”‚    â”‚  admin/grafana123                â”‚â”‚  â”‚
â”‚  â”‚  Next.js + TypeScript + Material â”‚â”‚    â”‚  Auto-configured datasource      â”‚â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚  â”‚
â”‚                                       â”‚                                        â”‚  â”‚
â”‚                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            REST API Calls (http://localhost:5002/api)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ Stack TecnolÃ³gico

### Componentes del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ğŸ—ï¸ TECNOLOGÃAS UTILIZADAS                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ–¥ï¸ HARDWARE & FIRMWARE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ESP8266 (WEMOS D1 R2)     â”‚ Microcontrolador principal WiFi                      â”‚
â”‚ Arduino Framework         â”‚ C++ con librerÃ­as especÃ­ficas                        â”‚
â”‚ â€¢ PubSubClient            â”‚ Cliente MQTT para ESP8266                            â”‚
â”‚ â€¢ ArduinoJson             â”‚ SerializaciÃ³n JSON                                   â”‚
â”‚ â€¢ DHT Sensor Library      â”‚ Lectura sensores temperatura/humedad                 â”‚
â”‚ â€¢ Adafruit BMP085         â”‚ PresiÃ³n baromÃ©trica                                   â”‚
â”‚ â€¢ BH1750 Library          â”‚ Sensor de luminosidad                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’» BACKEND & API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Node.js 18+               â”‚ Runtime JavaScript                                    â”‚
â”‚ Express.js 4.18           â”‚ Framework web minimalista                            â”‚
â”‚ â€¢ express-rate-limit      â”‚ Rate limiting                                         â”‚
â”‚ â€¢ helmet                  â”‚ Seguridad HTTP headers                               â”‚
â”‚ â€¢ cors                    â”‚ Cross-Origin Resource Sharing                        â”‚
â”‚ â€¢ morgan                  â”‚ HTTP request logger                                   â”‚
â”‚ MQTT.js                   â”‚ Cliente MQTT para Node.js                            â”‚
â”‚ InfluxDB 2.x Client       â”‚ Base de datos time-series                            â”‚
â”‚ Winston                   â”‚ Sistema de logging estructurado                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŒ FRONTEND & UI
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ React 19.1.1              â”‚ Library UI declarativa                               â”‚
â”‚ Next.js 15.4.6            â”‚ Framework React con SSR/SSG                          â”‚
â”‚ TypeScript 5.9.2          â”‚ Tipado estÃ¡tico para JavaScript                      â”‚
â”‚ Material-UI 7.3.1         â”‚ Componentes UI siguiendo Material Design            â”‚
â”‚ â€¢ @mui/material           â”‚ Componentes core                                      â”‚
â”‚ â€¢ @mui/icons-material     â”‚ IconografÃ­a                                           â”‚
â”‚ â€¢ @emotion/react          â”‚ CSS-in-JS styling                                     â”‚
â”‚ Chart.js 4.x              â”‚ GrÃ¡ficos y visualizaciones                           â”‚
â”‚ Leaflet 1.9+              â”‚ Mapas interactivos                                    â”‚
â”‚ â€¢ react-leaflet           â”‚ IntegraciÃ³n React                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ—„ï¸ ALMACENAMIENTO & INFRAESTRUCTURA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ InfluxDB 2.7              â”‚ Base de datos time-series                            â”‚
â”‚ â€¢ Flux Query Language     â”‚ Lenguaje consultas optimizado                        â”‚
â”‚ â€¢ Bucket: weather-data    â”‚ Almacenamiento datos meteorolÃ³gicos                  â”‚
â”‚ â€¢ Retention Policies      â”‚ GestiÃ³n automÃ¡tica de datos histÃ³ricos               â”‚
â”‚ Redis 7 Alpine            â”‚ Cache en memoria y sessions                          â”‚
â”‚ â€¢ Key-value store         â”‚ Cache API responses                                   â”‚
â”‚ â€¢ Session management      â”‚ AutenticaciÃ³n y estado                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¡ COMUNICACIÃ“N & MESSAGERÃA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Eclipse Mosquitto 2       â”‚ Broker MQTT ligero                                   â”‚
â”‚ â€¢ QoS Levels 0,1,2        â”‚ Quality of Service configurable                      â”‚
â”‚ â€¢ WebSocket Support       â”‚ Cliente web vÃ­a WS (puerto 9001)                     â”‚
â”‚ â€¢ Persistence             â”‚ Mensajes persistentes en disco                       â”‚
â”‚ â€¢ Authentication          â”‚ Opcional con usuarios/passwords                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š VISUALIZACIÃ“N & MONITOREO
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Grafana Latest            â”‚ Plataforma de monitoreo y visualizaciÃ³n              â”‚
â”‚ â€¢ InfluxDB Datasource     â”‚ ConexiÃ³n nativa con InfluxDB                         â”‚
â”‚ â€¢ Dashboard Templates     â”‚ Dashboards predefinidos                              â”‚
â”‚ â€¢ Alert Manager           â”‚ Sistema de alertas avanzado                          â”‚
â”‚ â€¢ User Management         â”‚ Control de acceso y roles                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ³ DEVOPS & CONTENEDORES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Docker Engine             â”‚ ContainerizaciÃ³n de servicios                        â”‚
â”‚ Docker Compose            â”‚ OrquestaciÃ³n multi-container                         â”‚
â”‚ â€¢ Networks: bridge        â”‚ Red interna para comunicaciÃ³n                        â”‚
â”‚ â€¢ Volumes: persistent     â”‚ Almacenamiento persistente                           â”‚
â”‚ â€¢ Health Checks           â”‚ Monitoreo de estado de servicios                     â”‚
â”‚ Alpine Linux Base         â”‚ ImÃ¡genes base ligeras                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Arquitectura de Despliegue

```
ğŸ  DESARROLLO LOCAL                           â˜ï¸ PRODUCCIÃ“N (Ejemplo)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                     â”‚      â”‚                                     â”‚
â”‚  ğŸ–¥ï¸ Host Machine (Windows)          â”‚      â”‚  ğŸŒ Cloud Provider                  â”‚
â”‚  â”œâ”€â”€ ğŸ“‚ Proyecto                    â”‚      â”‚  â”œâ”€â”€ ğŸ”„ Load Balancer               â”‚
â”‚  â”‚   â”œâ”€â”€ arduino/                   â”‚      â”‚  â”œâ”€â”€ ğŸ–¥ï¸ App Server                  â”‚
â”‚  â”‚   â”œâ”€â”€ backend/                   â”‚      â”‚  â”‚   â”œâ”€â”€ Node.js API (PM2)          â”‚
â”‚  â”‚   â”œâ”€â”€ frontend/                  â”‚      â”‚  â”‚   â””â”€â”€ Next.js Build              â”‚
â”‚  â”‚   â””â”€â”€ docker-compose.yml         â”‚      â”‚  â”œâ”€â”€ ğŸ—„ï¸ Database Server             â”‚
â”‚  â”œâ”€â”€ ğŸ³ Docker Desktop              â”‚      â”‚  â”‚   â”œâ”€â”€ InfluxDB Cluster           â”‚
â”‚  â”‚   â”œâ”€â”€ weather_influxdb:8086      â”‚      â”‚  â”‚   â””â”€â”€ Redis Cluster              â”‚
â”‚  â”‚   â”œâ”€â”€ weather_grafana:3000       â”‚      â”‚  â”œâ”€â”€ ğŸ“¡ MQTT Broker                 â”‚
â”‚  â”‚   â”œâ”€â”€ weather_mosquitto:1883     â”‚      â”‚  â”‚   â””â”€â”€ Mosquitto Cluster          â”‚
â”‚  â”‚   â””â”€â”€ weather_redis:6379         â”‚      â”‚  â””â”€â”€ ğŸ“Š Monitoring                  â”‚
â”‚  â”œâ”€â”€ Node.js Backend:5002           â”‚      â”‚      â”œâ”€â”€ Grafana                    â”‚
â”‚  â””â”€â”€ Next.js Frontend:3001+         â”‚      â”‚      â””â”€â”€ Prometheus + AlertManager â”‚
â”‚                                     â”‚      â”‚                                     â”‚
â”‚  ğŸŒ Network: bridge                 â”‚      â”‚  ğŸ”’ Security:                       â”‚
â”‚  ğŸ“¦ Volumes: local bind mounts      â”‚      â”‚  â”œâ”€â”€ SSL/TLS Certificates           â”‚
â”‚                                     â”‚      â”‚  â”œâ”€â”€ VPN Access                     â”‚
â”‚                                     â”‚      â”‚  â”œâ”€â”€ Firewall Rules                 â”‚
â”‚                                     â”‚      â”‚  â””â”€â”€ Secret Management              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ  ESP8266 Station                            ğŸ  ESP8266 Station  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¡ WEMOS_STATION_001               â”‚      â”‚  ğŸ“¡ WEMOS_STATION_002               â”‚
â”‚  â”œâ”€â”€ ğŸŒ¡ï¸ DHT22 (Temp/Humidity)      â”‚â—„â”€â”€â”€â”€â–ºâ”‚  â”œâ”€â”€ ğŸŒ¡ï¸ Different sensor config    â”‚
â”‚  â”œâ”€â”€ ğŸ§­ BMP180 (Pressure)           â”‚ WiFi â”‚  â”œâ”€â”€ ğŸŒªï¸ Anemometer + Wind Vane      â”‚
â”‚  â”œâ”€â”€ ğŸ’¡ BH1750 (Light)              â”‚      â”‚  â”œâ”€â”€ ğŸŒ§ï¸ Rain Gauge                  â”‚
â”‚  â”œâ”€â”€ ğŸŒ§ï¸ MH-RD (Rain detector)       â”‚      â”‚  â””â”€â”€ ğŸ”‹ Solar Panel + Battery       â”‚
â”‚  â”œâ”€â”€ ğŸ« MQ7 (CO)                    â”‚      â”‚                                     â”‚
â”‚  â”œâ”€â”€ ğŸ­ MQ135 (Air Quality)          â”‚      â”‚  ğŸ“ Remote Location                 â”‚
â”‚  â”œâ”€â”€ ğŸŒ«ï¸ DSM501A (PM2.5)             â”‚      â”‚  ğŸ”‹ Battery Powered                 â”‚
â”‚  â””â”€â”€ ğŸ”Œ USB Powered                 â”‚      â”‚  ğŸ“¡ Long Range WiFi                 â”‚
â”‚                                     â”‚      â”‚                                     â”‚
â”‚  ğŸ“ Indoor/Outdoor Station          â”‚      â”‚  â° Deep Sleep Mode                 â”‚
â”‚  ğŸ”„ 60s Reading Interval            â”‚      â”‚  ğŸ”„ 10min Reading Interval          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Inicio RÃ¡pido

### Prerrequisitos

- **Docker Desktop** (Windows/Mac) o **Docker Engine + Docker Compose** (Linux)
- **Node.js 18+** (para desarrollo local)
- **Arduino IDE 2.x** o **PlatformIO** (para firmware ESP8266)
- **Git** (para clonaciÃ³n del repositorio)

### 1. Configurar la Infraestructura

```bash
# Clonar el proyecto
git clone <repository-url>
cd estacion-metereologica

# Iniciar servicios con Docker
docker-compose up -d

# Verificar que todos los servicios estÃ©n funcionando
docker-compose ps
```

Servicios disponibles:
- **InfluxDB**: http://localhost:8086
- **Grafana**: http://localhost:3000 (admin/grafana123)
- **MQTT Broker**: localhost:1883

### 2. Configurar el Backend

```bash
cd backend

# Instalar dependencias
npm install

# Crear archivo de configuraciÃ³n
cp .env.example .env

# Iniciar en modo desarrollo (puerto 5002)
npm run dev
```

### 3. Configurar el Frontend

```bash
cd frontend

# Instalar dependencias
npm install

# Crear archivo de configuraciÃ³n
cp .env.example .env.local
# O crear .env.local con:
# NEXT_PUBLIC_API_URL=http://localhost:5002/api

# Iniciar en modo desarrollo
npm run dev
```

### 4. Configurar el Arduino/ESP32

1. Abrir `arduino/weather_station_wemos/weather_station_wemos.ino`
2. Configurar WiFi y MQTT:
```cpp
const char* ssid = "TU_WIFI_SSID";
const char* password = "TU_WIFI_PASSWORD";
const char* mqtt_server = "tu-servidor-mqtt.com";
```
3. Subir el cÃ³digo al ESP32

### ğŸŒ Servicios Disponibles

- **Frontend Dashboard**: http://localhost:3001+ (auto-asignado, evita 3000 usado por Grafana)
- **Backend API**: http://localhost:5002/api (Node.js/Express)
- **InfluxDB UI**: http://localhost:8086 (admin/weather123)
- **Grafana Dashboard**: http://localhost:3000 (admin/grafana123)
- **MQTT Broker**: localhost:1883 (WebSocket: 9001)

## ğŸ“Š API Endpoints

### Weather Data
- `POST /api/weather/data` - Enviar datos meteorolÃ³gicos
- `GET /api/weather/data/:stationId` - Obtener datos histÃ³ricos
- `GET /api/weather/data/:stationId/latest` - Ãšltimos datos
- `GET /api/weather/stations` - Listar estaciones

### Alertas
- `GET /api/alerts` - Obtener alertas
- `GET /api/alerts/:stationId` - Alertas por estaciÃ³n
- `POST /api/alerts` - Crear alerta manual

### Ejemplo de Uso

```bash
# Obtener Ãºltimos datos de una estaciÃ³n
curl http://localhost:5002/api/weather/data/ESP32_STATION_001/latest

# Obtener datos histÃ³ricos (Ãºltimos 30 minutos)
curl "http://localhost:5002/api/weather/data/ESP32_STATION_001?timeRange=30m"

# Exportar datos en CSV
curl "http://localhost:5002/api/weather/export/ESP32_STATION_001?format=csv&start=-7d"
```

## ğŸ”§ Hardware y ConfiguraciÃ³n ESP32/WEMOS

### Diagrama de Conexiones WEMOS D1 R2

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                    ğŸ–¥ï¸ WEMOS D1 R2                          â”‚
                    â”‚                 (ESP8266 Compatible)                       â”‚
                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚                                                             â”‚
          3V3 â”€â”€â”€â”€â”€â”€â”¤ 3V3                                                  RST â”œâ”€â”€â”€â”€â”€ RST
          GND â”€â”€â”€â”€â”€â”€â”¤ GND                                                   A0 â”œâ”€â”€â”€â”€â”€ ğŸŒ¬ï¸ MQ7 (CO)
           D0 â”€â”€â”€â”€â”€â”€â”¤ D0 (GPIO16)              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  D0 â”œâ”€â”€â”€â”€â”€
           D1 â”€â”€â”€â”€â”€â”€â”¤ D1 (GPIO5/SCL) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   I2C   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ D1 â”œâ”€â”€â”€â”€â”€ ğŸ”— SCL
           D2 â”€â”€â”€â”€â”€â”€â”¤ D2 (GPIO4/SDA) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   BUS   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ D2 â”œâ”€â”€â”€â”€â”€ ğŸ”— SDA
           D3 â”€â”€â”€â”€â”€â”€â”¤ D3 (GPIO0)               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  D3 â”œâ”€â”€â”€â”€â”€
           D4 â”€â”€â”€â”€â”€â”€â”¤ D4 (GPIO2) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ D4 â”œâ”€â”€â”€â”€â”€ ğŸŒ§ï¸ MH-RD (Rain)
         3V3 â”€â”€â”€â”€â”€â”€â”¤ 3V3                                                   D5 â”œâ”€â”€â”€â”€â”€ ğŸŒ¡ï¸ DHT22 (Data)
           D6 â”€â”€â”€â”€â”€â”€â”¤ D6 (GPIO12) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ D6 â”œâ”€â”€â”€â”€â”€ ğŸ­ MQ135 (Air Quality)
           D7 â”€â”€â”€â”€â”€â”€â”¤ D7 (GPIO13) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ D7 â”œâ”€â”€â”€â”€â”€ ğŸŒ«ï¸ DSM501A (PM2.5)
           D8 â”€â”€â”€â”€â”€â”€â”¤ D8 (GPIO15)                                           D8 â”œâ”€â”€â”€â”€â”€
         GND â”€â”€â”€â”€â”€â”€â”¤ GND                                                  5V â”œâ”€â”€â”€â”€â”€ 5V
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                              ğŸ“¡ WiFi: 2.4GHz (802.11 b/g/n)
                              ğŸ”Œ AlimentaciÃ³n: 5V/1A (USB/Barrel)
                              ğŸ’¾ Memoria: 4MB Flash
```

### ConexiÃ³n Detallada de Sensores

```
ğŸŒ¡ï¸ DHT22 (Temperatura y Humedad)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DHT22        â”‚    â”‚   WEMOS D1 R2   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ VCC (Pin 1) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ 3V3             â”‚
â”‚ DATA (Pin 2) â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ D5 (GPIO14)     â”‚ + Pull-up 10kÎ© a 3V3
â”‚ NC (Pin 3)      â”‚    â”‚                 â”‚
â”‚ GND (Pin 4) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ§­ BMP180 (PresiÃ³n BaromÃ©trica) + ğŸ’¡ BH1750 (Luminosidad)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     BMP180      â”‚    â”‚   I2C BUS       â”‚    â”‚    BH1750       â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ VCC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ 3V3             â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VCC â”‚
â”‚ GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GND â”‚
â”‚ SCL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ D1 (GPIO5/SCL)  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SCL â”‚
â”‚ SDA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ D2 (GPIO4/SDA)  â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ SDA â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ I2C Addr: 0x77  â”‚    â”‚ Pull-ups: 4.7kÎ© â”‚    â”‚ I2C Addr: 0x23  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŒ§ï¸ MH-RD (Sensor de Lluvia)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     MH-RD       â”‚    â”‚   WEMOS D1 R2   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ VCC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ 3V3             â”‚
â”‚ GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”‚
â”‚ DO (Digital) â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ D4 (GPIO2)      â”‚ â† Interrupt Pin
â”‚ AO (Analog) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ No Connect      â”‚   (Opcional)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ« MQ7 (MonÃ³xido de Carbono)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MQ7        â”‚    â”‚   WEMOS D1 R2   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ VCC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ 5V (Para heater)â”‚
â”‚ GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”‚
â”‚ DO (Digital) â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ No Connect      â”‚
â”‚ AO (Analog) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ A0 (ADC)        â”‚ â† 0-1024 (0-3.3V)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ­ MQ135 (Calidad del Aire)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     MQ135       â”‚    â”‚   WEMOS D1 R2   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ VCC â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ 3V3             â”‚
â”‚ GND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”‚
â”‚ DO (Digital) â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ D6 (GPIO12)     â”‚ â† Threshold detect
â”‚ AO (Analog) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ No Connect      â”‚   (Opcional)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸŒ«ï¸ DSM501A (PartÃ­culas PM2.5)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    DSM501A      â”‚    â”‚   WEMOS D1 R2   â”‚
â”‚                 â”‚    â”‚                 â”‚
â”‚ VCC (Pin 3) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ 5V              â”‚
â”‚ GND (Pin 1) â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”‚
â”‚ PM2.5 (Pin 4) â”€â”€â”¼â”€â”€â”€â”€â”¤ D7 (GPIO13)     â”‚ â† Pulse width measure
â”‚ PM10 (Pin 2) â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ No Connect      â”‚   (Opcional)
â”‚ CTRL (Pin 5) â”€â”€â”€â”¼â”€â”€â”€â”€â”¤ GND             â”‚   (Always enabled)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Especificaciones TÃ©cnicas WEMOS D1 R2

| Componente | EspecificaciÃ³n |
|------------|----------------|
| **Microcontrolador** | ESP8266 (80/160 MHz) |
| **Memoria Flash** | 4MB |
| **RAM** | 80KB |
| **GPIO Digitales** | 11 pines (D0-D8, TX, RX) |
| **GPIO AnalÃ³gicos** | 1 pin (A0) - 0-3.3V, 10-bit ADC |
| **I2C** | D1 (SCL), D2 (SDA) |
| **SPI** | D5 (CLK), D6 (MISO), D7 (MOSI), D8 (CS) |
| **UART** | TX, RX |
| **WiFi** | 802.11 b/g/n (2.4 GHz) |
| **AlimentaciÃ³n** | 5V (USB/Barrel) / 3.3V (Regulado) |
| **Consumo** | ~80mA (activo), ~20ÂµA (deep sleep) |

### Tabla de Conexiones Consolidada

| Sensor | Pin WEMOS | Pin GPIO | Tipo | Voltaje | Protocolo | DescripciÃ³n |
|--------|-----------|----------|------|---------|-----------|-------------|
| ğŸŒ¡ï¸ DHT22 | D5 | GPIO14 | Digital | 3.3V | OneWire | Temperatura y humedad |
| ğŸ§­ BMP180 SDA | D2 | GPIO4 | I2C | 3.3V | I2C | PresiÃ³n baromÃ©trica |
| ğŸ§­ BMP180 SCL | D1 | GPIO5 | I2C | 3.3V | I2C | PresiÃ³n baromÃ©trica |
| ğŸ’¡ BH1750 SDA | D2 | GPIO4 | I2C | 3.3V | I2C | Sensor de luz (compartido) |
| ğŸ’¡ BH1750 SCL | D1 | GPIO5 | I2C | 3.3V | I2C | Sensor de luz (compartido) |
| ğŸŒ§ï¸ MH-RD | D4 | GPIO2 | Digital | 3.3V | Interrupt | Sensor de lluvia |
| ğŸ« MQ7 | A0 | ADC0 | AnalÃ³gico | 5V | ADC | MonÃ³xido de carbono |
| ğŸ­ MQ135 | D6 | GPIO12 | Digital | 3.3V | Digital | Calidad del aire |
| ğŸŒ«ï¸ DSM501A | D7 | GPIO13 | Digital | 5V | PWM | PartÃ­culas PM2.5 |

### Protocolo MQTT - Estructura de ComunicaciÃ³n

```
ğŸ“¡ MQTT Topics Structure
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ğŸ”— MQTT COMMUNICATION                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¤ PUBLICACIÃ“N (ESP8266 â†’ Broker)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Topic: weather/data/WEMOS_STATION_001                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Payload JSON:                                                                   â”‚  â”‚
â”‚  â”‚ {                                                                               â”‚  â”‚
â”‚  â”‚   "station_id": "WEMOS_STATION_001",      // ID Ãºnico de la estaciÃ³n           â”‚  â”‚
â”‚  â”‚   "timestamp": 1234567890,                // millis() del ESP8266              â”‚  â”‚
â”‚  â”‚   "temperature": 25.67,                   // Â°C (DHT22)                        â”‚  â”‚
â”‚  â”‚   "humidity": 65.23,                      // % (DHT22)                         â”‚  â”‚
â”‚  â”‚   "pressure": 1013.25,                    // hPa (BMP180)                      â”‚  â”‚
â”‚  â”‚   "light_level": 1234.56,                 // Lux (BH1750)                      â”‚  â”‚
â”‚  â”‚   "rainfall": 0.2,                        // mm (MH-RD pulses)                 â”‚  â”‚
â”‚  â”‚   "co_level": 2.45,                       // ppm (MQ7)                         â”‚  â”‚
â”‚  â”‚   "co_raw": 512,                          // ADC value (0-1024)                â”‚  â”‚
â”‚  â”‚   "air_quality_digital": 0,               // 0/1 (MQ135)                       â”‚  â”‚
â”‚  â”‚   "dust_pm25": 12.34,                     // Î¼g/mÂ³ (DSM501A)                   â”‚  â”‚
â”‚  â”‚   "uptime": 12345,                        // Segundos desde boot               â”‚  â”‚
â”‚  â”‚   "signal_strength": -45,                 // dBm RSSI                          â”‚  â”‚
â”‚  â”‚   "free_heap": 25600                      // Bytes libres                      â”‚  â”‚
â”‚  â”‚ }                                                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Frecuencia: Cada 60 segundos                                                       â”‚
â”‚  QoS: 0 (Fire and forget)                                                           â”‚
â”‚  Retain: false                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¤ ESTADO DEL SISTEMA (ESP8266 â†’ Broker)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Topic: weather/status/WEMOS_STATION_001                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ {                                                                               â”‚  â”‚
â”‚  â”‚   "station_id": "WEMOS_STATION_001",                                           â”‚  â”‚
â”‚  â”‚   "status": "online",                     // online/offline/error              â”‚  â”‚
â”‚  â”‚   "timestamp": 1234567890,                                                     â”‚  â”‚
â”‚  â”‚   "uptime": 12345,                                                             â”‚  â”‚
â”‚  â”‚   "signal_strength": -45,                                                      â”‚  â”‚
â”‚  â”‚   "free_heap": 25600,                                                          â”‚  â”‚
â”‚  â”‚   "sensors": {                                                                 â”‚  â”‚
â”‚  â”‚     "dht22": true,                        // Estados de sensores               â”‚  â”‚
â”‚  â”‚     "bmp180": true,                                                            â”‚  â”‚
â”‚  â”‚     "bh1750": true,                                                            â”‚  â”‚
â”‚  â”‚     "mh_rd": false,                                                            â”‚  â”‚
â”‚  â”‚     "mq7": false,                                                              â”‚  â”‚
â”‚  â”‚     "mq135": false,                                                            â”‚  â”‚
â”‚  â”‚     "dsm501a": false                                                           â”‚  â”‚
â”‚  â”‚   }                                                                            â”‚  â”‚
â”‚  â”‚ }                                                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Frecuencia: Al conectar, bajo comando, o cambio de estado                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“¥ COMANDOS REMOTOS (Broker â†’ ESP8266)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Topic: weather/command/WEMOS_STATION_001 (SUSCRIPCIÃ“N)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Comando: Reiniciar dispositivo                                                  â”‚  â”‚
â”‚  â”‚ {"command": "restart"}                                                          â”‚  â”‚
â”‚  â”‚                                                                                 â”‚  â”‚
â”‚  â”‚ Comando: Solicitar estado                                                       â”‚  â”‚
â”‚  â”‚ {"command": "status"}                                                           â”‚  â”‚
â”‚  â”‚                                                                                 â”‚  â”‚
â”‚  â”‚ Comando: Verificar sensores                                                     â”‚  â”‚
â”‚  â”‚ {"command": "sensor_check"}                                                     â”‚  â”‚
â”‚  â”‚                                                                                 â”‚  â”‚
â”‚  â”‚ Comando: Configurar intervalo                                                   â”‚  â”‚
â”‚  â”‚ {"command": "set_interval", "value": 30}  // Segundos                          â”‚  â”‚
â”‚  â”‚                                                                                 â”‚  â”‚
â”‚  â”‚ Comando: Modo bajo consumo                                                      â”‚  â”‚
â”‚  â”‚ {"command": "deep_sleep", "duration": 3600}  // Segundos                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Respuesta: Inmediata con acknowledge o estado actualizado                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š BROKER MQTT (Mosquitto)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”— Eclipse Mosquitto                                                               â”‚
â”‚  â€¢ Puerto: 1883 (TCP)                                                               â”‚
â”‚  â€¢ Puerto WebSocket: 9001                                                           â”‚
â”‚  â€¢ AutenticaciÃ³n: Opcional                                                          â”‚
â”‚  â€¢ Persistencia: Habilitada                                                         â”‚
â”‚  â€¢ Logs: /mosquitto/log/mosquitto.log                                               â”‚
â”‚  â€¢ ConfiguraciÃ³n: /mosquitto/config/mosquitto.conf                                  â”‚
â”‚                                                                                      â”‚
â”‚  ğŸ” Comandos de debugging:                                                          â”‚
â”‚  docker exec weather_mosquitto mosquitto_sub -h localhost -t "weather/data/+" -v    â”‚
â”‚  docker exec weather_mosquitto mosquitto_pub -h localhost -t "weather/command/...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CalibraciÃ³n de Sensores

Editar valores en el cÃ³digo Arduino (`CalibrationFactors` struct):
```cpp
struct CalibrationFactors {
  float temp_offset = 0.0;       // CompensaciÃ³n temperatura (Â°C)
  float temp_scale = 1.0;        // Factor de escala temperatura
  float humidity_offset = 0.0;   // CompensaciÃ³n humedad (%)
  float pressure_offset = 0.0;   // CompensaciÃ³n presiÃ³n (hPa)
  float rain_factor = 0.2;       // mm por pulso del pluviÃ³metro
  float mq7_offset = 0.0;        // Offset sensor CO (ppm)
  float mq135_offset = 0.0;      // Offset sensor calidad aire
};
```

## ğŸ“ˆ Dashboard y VisualizaciÃ³n

### Grafana
- Acceder a http://localhost:3000
- Usuario: `admin` / ContraseÃ±a: `grafana123`
- El datasource de InfluxDB ya estÃ¡ preconfigurado

### Consultas de Ejemplo

```flux
// Temperatura Ãºltimas 24h
from(bucket: "weather-data")
  |> range(start: -24h)
  |> filter(fn: (r) => r._measurement == "weather")
  |> filter(fn: (r) => r._field == "temperature")
```

## âš ï¸ Sistema de Alertas

### Reglas Predefinidas

- Temperatura > 40Â°C â†’ ALTA
- Viento > 60 km/h â†’ CRÃTICA
- BaterÃ­a < 11.5V â†’ ALTA
- PM2.5 > 150 Î¼g/mÂ³ â†’ ALTA

### PersonalizaciÃ³n

Editar `backend/src/services/alertService.js` para agregar nuevas reglas.

## ğŸ”§ Scripts Ãštiles

### Backend
```bash
npm start     # ProducciÃ³n
npm run dev   # Desarrollo (puerto 5002)
npm test      # Pruebas
```

### Frontend
```bash
npm run dev   # Desarrollo (puerto auto-asignado 3001+)
npm run build # Compilar para producciÃ³n
npm start     # Servidor de producciÃ³n
```

### Docker
```bash
docker-compose up -d          # Iniciar servicios
docker-compose down           # Detener servicios
docker-compose logs -f        # Ver logs
docker-compose restart influxdb  # Reiniciar servicio
```

## âš™ï¸ ConfiguraciÃ³n Importante

### Variables de Entorno Frontend
**IMPORTANTE**: El frontend DEBE tener `.env.local` con:
```bash
NEXT_PUBLIC_API_URL=http://localhost:5002/api
```
Sin este archivo, las llamadas a la API fallarÃ¡n con errores "Failed to fetch".

### GestiÃ³n de Puertos
- **Backend**: Puerto 5002 (configurable via `PORT` en `.env`)
- **Frontend**: Auto-asigna puertos disponibles (3001+, evita 3000 usado por Grafana)
- **Conflictos**: Next.js detecta automÃ¡ticamente puertos ocupados y asigna el siguiente disponible

## ğŸ“ Estructura del Proyecto

```
estacion-metereologica/
â”œâ”€â”€ arduino/
â”‚   â”œâ”€â”€ weather_station_wemos/
â”‚   â”‚   â”œâ”€â”€ weather_station_wemos.ino
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”œâ”€â”€ weather_station_esp32/
â”‚   â””â”€â”€ sensores-microcontroladores.md
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ influxdb.js
â”‚   â”‚   â”‚   â””â”€â”€ logger.js
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”‚   â”œâ”€â”€ alertController.js
â”‚   â”‚   â”‚   â””â”€â”€ weatherController.js
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ alertRoutes.js
â”‚   â”‚   â”‚   â””â”€â”€ weatherRoutes.js
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ alertService.js
â”‚   â”‚   â”‚   â””â”€â”€ mqttService.js
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â”œâ”€â”€ rateLimiter.js
â”‚   â”‚   â”‚   â””â”€â”€ validation.js
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ AlertsPanel.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ CurrentMeasurements.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ HistoricalCharts.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SystemStatus.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ WeatherMap.tsx
â”‚   â”‚   â”‚   â””â”€â”€ WeatherMapClient.tsx
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ _app.tsx
â”‚   â”‚   â”‚   â””â”€â”€ _document.tsx
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â”œâ”€â”€ weatherService.ts
â”‚   â”‚       â””â”€â”€ socketService.ts
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ grafana/
â”‚   â”‚   â””â”€â”€ provisioning/
â”‚   â””â”€â”€ mosquitto/
â”‚       â””â”€â”€ config/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ CLAUDE.md
â””â”€â”€ README.md
```

## ğŸ› ï¸ Desarrollo

### Agregar Nuevos Sensores

1. **Hardware**: Conectar sensor al ESP32
2. **Arduino**: Agregar lectura en `readAndSendData()` en `weather_station_wemos.ino`
3. **Backend**: Actualizar validaciÃ³n en `middleware/validation.js`
4. **Frontend**: Agregar visualizaciÃ³n en componentes React correspondientes
5. **Base de datos**: Los campos se crean automÃ¡ticamente en InfluxDB

### Personalizar Alertas

1. Editar reglas en `backend/src/services/alertService.js`
2. Configurar notificaciones (email, SMS, etc.)
3. Crear dashboard especÃ­fico en Grafana
4. Agregar visualizaciÃ³n de alertas en componente `AlertsPanel.tsx`

## ğŸ“¦ Despliegue en ProducciÃ³n

### Variables de Entorno

**Backend (.env)**:
```bash
NODE_ENV=production
PORT=5002
INFLUXDB_TOKEN=<token-seguro>
INFLUXDB_URL=<url-influxdb>
INFLUXDB_ORG=weather-station
INFLUXDB_BUCKET=weather-data
MQTT_USERNAME=<usuario>
MQTT_PASSWORD=<contraseÃ±a>
```

**Frontend (.env.local)**:
```bash
NEXT_PUBLIC_API_URL=http://localhost:5002/api
NODE_ENV=production
```

### SSL/TLS

Configurar certificados para:
- MQTT (puerto 8883)
- HTTP API (puerto 443)
- InfluxDB (puerto 8086)

## ğŸ¤ Contribuir

1. Fork del proyecto
2. Crear rama para feature (`git checkout -b feature/nueva-funcionalidad`)
3. Commit cambios (`git commit -am 'Agregar nueva funcionalidad'`)
4. Push a la rama (`git push origin feature/nueva-funcionalidad`)
5. Crear Pull Request

## ğŸ“„ Licencia

MIT License - ver archivo [LICENSE](LICENSE) para detalles.

## ğŸ” SoluciÃ³n de Problemas

### Problemas Comunes

1. **Error "Failed to fetch" en frontend**:
   - Verificar que `.env.local` existe con `NEXT_PUBLIC_API_URL=http://localhost:5002/api`
   - Confirmar que el backend estÃ© ejecutÃ¡ndose en puerto 5002

2. **Puerto 3000 ocupado**:
   - Next.js auto-asigna el siguiente puerto disponible (3001, 3002, etc.)
   - Grafana usa puerto 3000 por defecto

3. **Conflictos de puertos**:
   ```bash
   # Verificar procesos en puerto especÃ­fico
   netstat -ano | findstr :5002
   # Terminar proceso si es necesario
   cmd /c "taskkill /F /PID <process_id>"
   ```

4. **Datos no aparecen en dashboard**:
   - Verificar conexiÃ³n MQTT: `docker logs weather_mosquitto`
   - Comprobar logs del backend: `npm run dev`
   - Revisar InfluxDB: http://localhost:8086

### Lista de VerificaciÃ³n del Sistema

1. âœ… Docker services: `docker-compose ps`
2. âœ… Backend API: `curl http://localhost:5002/health`
3. âœ… Frontend: Verificar puerto auto-asignado en consola
4. âœ… MQTT: `docker exec weather_mosquitto mosquitto_sub -h localhost -t "weather/data/+" -v`

## ğŸ†˜ Soporte

- **Issues**: Reportar problemas en GitHub
- **Wiki**: DocumentaciÃ³n adicional
- **Discussions**: Preguntas y discusiones de la comunidad

---

**âš¡ Weather Station IoT - Monitoreo meteorolÃ³gico inteligente**